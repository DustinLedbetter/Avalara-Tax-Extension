******************************************************************************************                                 GOD first                                             *
*Name: Dustin Ledbetter                                                                 *
*Date: 10-16-2018                                                                       *
*Pageflex Extension: AvalaraTaxExtension                                                *
*Purpose: A step by step explanation of what the AvalaraTaxExtension does               *
*****************************************************************************************

Walkthrough of the Process to Calculate a New Tax Rate
======================================================

-------------------------------------------------
-Steps the user takes before the extension runs:-
-------------------------------------------------
*(Let’s walk through the process the user follows to activate the AvalaraTaxExtension)*

1. Login to the User Portal of the storefront
2. The user browses the storefront and places an item in their shopping cart
3. From the shopping cart the user hits the button 'Proceed to Checkout'
4. The user fills in, selects from an address book, or has auto filled for them the shipping address information for their order.
5. The user then selects a delivery method and hits 'Update Shipping Charges'

*(Once the user hits 'Update Shipping Charges' the AvalaraTaxExtension runs)*

-----------------------------------------
-The Process of the AvalaraTaxExtension - 
-----------------------------------------
1. The method 'IsModuleType' which is checking to see if we are on the shipping page gets flagged to true the moment the user chooses to proceed form their 'Shopping Cart' to the 'Shipping Page'. This tells the extension it will be ran soon and waits till the method we are going to override is called upon.

2. Once the user completes the steps to enter their address info and they hit the 
'Update Shipping Charges' button on the 'Shipping Page' the storefront runs several methods to calculate the subtotal, shipping fees, handling fees, and taxes for the customer’s order. 

3. It is at this time the 'AvalaraTaxExtension' is called to override the 'CalculateTax2' method that calculates the amount of taxes for the order.

4. Our method does several things at this point:
1. It first takes in all of the users shipping address information and saves them in variables to be used when it makes a call out to Avalara.
2. It makes a database call to retrieve the shipping charge, handling charge, and subtotal for the current order and saves them in variables to also be used when it makes a call out to Avalara.
3. Once it has the needed fields above it creates a connection call out to Avalara with the credentials for the Communicorp Company.
4. If successful, we then create a transaction and pass the users shipping address information and the totals to be used for calculating the new tax rate.
5. Avalara uses this information passed to calculate the new tax rate based on their updated tax tables.
6. We take the new rate returned by Avalara and send it back to the storefront.

*(At This point we end our interruption and let the storefront finish its process so it can then display the shipping charge, handling charge, subtotal, and the new tax rate to the user)*
